{{- $page := .Page -}}
{{- $context := path.Dir .File.Path -}}
{{- $pageURL := .Permalink -}}

{{ .Content }}
<div class="iiif">
    {{- if (hasPrefix .Page.Params.iiifcontext "http://iiif.io/api/image/") -}}
        {{- range .Params.resources -}}
          {{- if or (or (eq .name "front") (eq .name "title")) (eq .name "cover") -}}
            {{ partial "iiif/iiif-image.html" (dict "context" . "contextPath" $context "pageURL" .Permalink "heading" (i18n .name) "pageContext" $page "site" $.Site) }}
          {{- end -}}
        {{- end -}}
    {{- else if (hasPrefix .Page.Params.iiifcontext "http://iiif.io/api/presentation/") -}}
        {{- partial "iiif/iiif-presentation.html" . -}}
    {{- end -}}
</div>
{{- if and (isset .Page.Params "type") (eq .Page.Params.type "3d") -}}
    {{ partial "3d.html" . }}
{{- end -}}
